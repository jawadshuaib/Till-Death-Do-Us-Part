{"remainingRequest":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/src/components/TextForm.vue?vue&type=style&index=0&id=340f5741&scoped=true&lang=css&","dependencies":[{"path":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/src/components/TextForm.vue","mtime":1553125213987},{"path":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jawadshuaib/Desktop/js/vue-projects/till-death-do-us-part/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#progress-bar-indeterminate {\n  display: none;\n}\n.col-second {\n  top: 0;\n  min-height: 100vh;\n  background-color: #fff;\n}\n.project-desc-container {\n  position: absolute;\n  top: 35%;\n  transform: translateY(-50%);\n  text-align: center;\n  width: 48%;\n}\n.project-desc .logo img {\n  max-width: 150px;\n}\n.project-desc .headline {\n  color: #2bbbad;\n  font-size: 32px;\n  font-weight: 800;\n}\n.project-desc .desc {\n  color: #757575;\n  font-size: 16px;\n}\n.form-container {\n  margin-left: auto;\n  margin-right: auto;\n  max-width: 600px;\n  width: 100%;\n  position: relative;\n  /* top: 50%;\n  transform: translateY(-50%); */\n}\n#progress-bar-container {\n  display: none;\n}\n.progress-bar-strip,\n.progress-bar-panel {\n  padding: 0.01em 16px;\n}\n.progress-bar-green,\n.progress-bar-hover-green:hover {\n  color: #fff;\n  background-color: #4caf50;\n}\n.progress-bar-center {\n  text-align: center;\n}\n.card-panel {\n  background-color: #fff;\n}\n#note,\nlabel,\n#password {\n  font-size: 22px;\n  font-weight: lighter;\n  color: #757575;\n}\n#note,\nlabel {\n  width: 600px;\n}\n\n@media only screen and (max-width: 600px) {\n  .col-second {\n    background: none;\n  }\n  .submit-btn {\n    width: 300px;\n  }\n}\n",{"version":3,"sources":["TextForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TextForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"row\">\n    <div class=\"col s6 col-first hide-on-small-only\">\n      <div class=\"project-desc-container\">\n        <div class=\"project-desc\">\n          <div class=\"logo\">\n            <img src=\"../assets/logo.png\">\n          </div>\n          <div class=\"headline\">Is there is a message you would like to securely save forever?</div>\n          <div\n            class=\"desc\"\n          >Use the blockchain to store and share a message only you or your loved ones can view.</div>\n        </div>\n      </div>\n    </div>\n    <div class=\"col s6 col-second valign-wrapper align-center\">\n      <form class=\"form-container\">\n        <div>\n          <div id=\"progress-bar-container\">\n            <div class=\"progress-bar-light-grey\">\n              <div\n                id=\"progress-bar\"\n                class=\"progress-bar-strip progress-bar-green progress-bar-center\"\n                style=\"width:0%\"\n              >0%</div>\n            </div>\n          </div>\n          <div class=\"input-field\">\n            <textarea id=\"note\" v-model=\"form.note\" class=\"materialize-textarea active\"></textarea>\n            <label for=\"note\" v-if=\"isTest\">{{ genericNote }} {{ networks.test }}.</label>\n            <label for=\"note\" v-else>{{ genericNote }} {{ networks.blockchain }}.</label>\n          </div>\n          <div>\n            <button\n              class=\"btn waves-effect waves-light btn-large submit-btn\"\n              type=\"submit\"\n              name=\"action\"\n              @click.prevent=\"submitForm()\"\n            >\n              Save on the\n              <span v-if=\"isTest\">{{ networks.test }}</span>\n              <span v-else>{{ networks.blockchain }}</span>\n              <i class=\"material-icons right\">send</i>\n            </button>\n            <div>\n              <div class=\"error\" v-if=\"error!==null\">{{ error }}</div>\n            </div>\n            <div>\n              <label>\n                <input type=\"checkbox\" v-on:click=\"selectNetwork($event)\">\n                <span>Permanently Save on the Blockchain (Costs Ether)</span>\n              </label>\n            </div>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport commonHelpers from \"@/helpers/common\";\nimport blockchainHelpers from \"@/helpers/blockchain\";\n\nimport web3 from \"./../web3\";\nimport notesContract from \"./../notes\";\n\nimport CryptoJS from \"crypto-js\";\n\nglobal.jQuery = require(\"jquery\");\nvar $ = global.jQuery;\nwindow.$ = $;\n\nexport default {\n  name: \"TextForm\",\n  data() {\n    return {\n      contract: {\n        owner: null,\n        transactionHash: null\n      },\n      networks: {\n        test: \"Test Network\",\n        blockchain: \"Blockchain\"\n      },\n      genericNote: \"Write a note you wish to save on the Ethereum\",\n      isTest: true,\n      note: null,\n      form: {\n        note: \"\",\n        secretKey: \"\",\n        token: \"\"\n      },\n      error: null\n    };\n  },\n  methods: {\n    selectNetwork(e) {\n      if (e.target.checked) {\n        this.isTest = false;\n      } else {\n        this.isTest = true;\n      }\n    },\n    async submitForm() {\n      this.form.token = commonHelpers.generateRandomDigits(8);\n      this.form.secretKey = commonHelpers.generateRandomDigits(8);\n\n      const token = this.form.token;\n\n      let canSubmit = false;\n      if (this.isFormValid()) {\n        canSubmit = true;\n      }\n\n      if (!(await blockchainHelpers.doesTokenExist(token))) {\n        canSubmit = true;\n      } else {\n        canSubmit = false;\n        this.error =\n          \"A note with this token already exists. Please refresh and try again!\";\n      }\n\n      if (canSubmit) {\n        const dt = new Date();\n        const dateCreated = dt.getTime();\n\n        this.createNote(token, dateCreated, this.form.note);\n      }\n    },\n    isFormValid() {\n      this.error = null;\n      if (this.form.note === \"\" || this.form.secretKey === \"\") {\n        this.error = \"Please write a note.\";\n      }\n      return this.error === null ? true : false;\n    },\n    // encryptNote(note) {\n    //   return CryptoJS.AES.encrypt(note, this.form.secretKey).toString();\n    // },\n    async createNote(token, dateCreated, note) {\n      // submit the form\n      const account = await blockchainHelpers.getAccount();\n      if (account === null) {\n        const err = \"Please log into metamask account to proceed.\";\n        this.error = err;\n        alert(err);\n      }\n\n      if (this.error === null) {\n        // encrypt the note\n        note = commonHelpers.encryptAES(note, this.form.secretKey);\n        await notesContract.methods\n          .createNote(\n            token,\n            dateCreated,\n            commonHelpers.encryptSHA256(account),\n            note\n          )\n          .send({\n            from: account\n          })\n          .on(\"transactionHash\", tx => {\n            this.contract.transactionHash = tx;\n            runProgressBar();\n            // this.$emit(\"animate\", { action: true });\n          })\n          .on(\"confirmation\", () => {\n            // this.$emit(\"animate\", { action: false });\n            this.$router.push({\n              name: \"TransactionDetails\",\n              params: {\n                transaction_id: this.contract.transactionHash,\n                token: this.form.token,\n                secretKey: this.form.secretKey,\n                whichNetwork: this.isTest === true ? \"rinkeby\" : \"mainnet\"\n              }\n            });\n          });\n      }\n    }\n  },\n  async created() {\n    this.contract.owner = await notesContract.methods.owner().call();\n  }\n  // updated() {\n  //   $(document).ready(function() {\n  //     // resize textarea\n  //     // M.updateTextFields();\n  //     // M.textareaAutoResize($(\"#note\"));\n  //   });\n  //   // $(\"document\").on(\"keypress\", function(e) {\n  //   //   $(\"#note\").focus();\n  //   // });\n  // }\n};\n\n$(document).ready(function() {\n  // keep waves at the bottom as additional lines of the note are added\n  $(\"#note\").on(\"keypress\", function(e) {\n    const text = $(this).val();\n    const lines = text.split(/\\r|\\r\\n|\\n/);\n    const totalLines = lines.length;\n\n    if (totalLines > 3) {\n      if (e.which == 13) {\n        $(\".ocean\").css(\"bottom\", `-${totalLines * 48}px`);\n      }\n    }\n  });\n});\n\nfunction runProgressBar() {\n  const container = document.getElementById(\"progress-bar-container\");\n  container.style.display = \"block\";\n\n  let elem = document.getElementById(\"progress-bar\");\n  let width = 0;\n  let id = setInterval(frame, 200);\n  function frame() {\n    if (width >= 100) {\n      elem.innerHTML = \"Your note has been submitted successfully! Stand by...\";\n      clearInterval(id);\n    } else {\n      width++;\n      elem.style.width = width + \"%\";\n      elem.innerHTML = width * 1 + \"%\";\n    }\n  }\n}\n</script>\n\n<style scoped>\n#progress-bar-indeterminate {\n  display: none;\n}\n.col-second {\n  top: 0;\n  min-height: 100vh;\n  background-color: #fff;\n}\n.project-desc-container {\n  position: absolute;\n  top: 35%;\n  transform: translateY(-50%);\n  text-align: center;\n  width: 48%;\n}\n.project-desc .logo img {\n  max-width: 150px;\n}\n.project-desc .headline {\n  color: #2bbbad;\n  font-size: 32px;\n  font-weight: 800;\n}\n.project-desc .desc {\n  color: #757575;\n  font-size: 16px;\n}\n.form-container {\n  margin-left: auto;\n  margin-right: auto;\n  max-width: 600px;\n  width: 100%;\n  position: relative;\n  /* top: 50%;\n  transform: translateY(-50%); */\n}\n#progress-bar-container {\n  display: none;\n}\n.progress-bar-strip,\n.progress-bar-panel {\n  padding: 0.01em 16px;\n}\n.progress-bar-green,\n.progress-bar-hover-green:hover {\n  color: #fff;\n  background-color: #4caf50;\n}\n.progress-bar-center {\n  text-align: center;\n}\n.card-panel {\n  background-color: #fff;\n}\n#note,\nlabel,\n#password {\n  font-size: 22px;\n  font-weight: lighter;\n  color: #757575;\n}\n#note,\nlabel {\n  width: 600px;\n}\n\n@media only screen and (max-width: 600px) {\n  .col-second {\n    background: none;\n  }\n  .submit-btn {\n    width: 300px;\n  }\n}\n</style>"]}]}